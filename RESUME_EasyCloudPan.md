# EasyCloudPan 项目亮点与技术难点

## 项目概览
- 项目名称：EasyCloudPan（前后端分离网盘系统）
- 技术栈：Java 21、Spring Boot 3.2、MyBatis-Flex、PostgreSQL、Redis、MinIO、Vue 3、Vite、Docker Compose、Prometheus/Grafana
- 项目定位：覆盖用户认证、文件上传下载、分享转存、回收站、文件预览、多租户、监控告警的一体化网盘系统

## 核心亮点（通俗与专业并重，彰显系统分量）

1. **全面压榨硬件潜能的高并发模型（Java 21 虚拟线程 + S3 预签直连）**：  
   打破了传统的“应用端做中转”瓶颈。我设计并落地了基于 Java 21 最新虚拟线程机制的高并发模型，将耗时的请求与异步任务彻底重构。同时，引入类似“给用户发 VIP 私人直通卡”的 S3 Presigner 技术，文件下载时完全绕开应用自己的带宽网关，直接从对象存储底座把速度拉满，极大提升了多用户同时在线拉取文件的极限吞吐能力。  
2. **坚不可摧的超硬核大文件上传主轴（分片机制 + 守护清理进程）**：  
   像拼乐高一样处理几个 G 的大文件，构建了从“碎片化传输”到“断点续传”、“一秒传完（秒传）”的完整链路。此外，为了防止由于网络中断导致的大文件“残骸”占用服务器宝贵的存储空间，特别研发了后端定时巡逻的守护机器进程（`@Scheduled`），能精准识别并清理无主垃圾数据，确保服务器磁盘永远处于健康水位。  
3. **丝滑无感的极客级前后端交互交互升维（SSE 推送 + 前台虚拟渲染与护线）**：  
   彻底改革了应用交互方式。后端使用“单工无负担推送（SseEmitter + 协程）”取代了以前像“小孩不断问大人到了没”一样极其消耗服务器性能的 HTTP 高频轮询。而在前端页面，通过引入按需加载的“虚拟动态大屏（Virtual Scroller）”和限制并发人数的“劳工计算池（Web Worker Pool）”，就算用户一口气打开装有十万个文件的文件夹，浏览器也绝不卡顿白屏甚至内存爆仓（OOM）。  
4. **扛住流量洪峰的立体化多级防线（Caffeine + Redis + DB 与防微杜渐策略）**：  
   系统性地建立了犹如“三道城墙”一般的多级缓存架构（本地极速缓存 + 分布式快存 + 数据库托底）。面对可能拖垮数据库的恶意请求（如缓存穿透、雪崩、击穿），创造性地运用了“空值伪装缓存”、“布隆过滤器（海量数据点名册）”、“分布式安全锁”和“随机错峰过期”等一系列手段，构建了牢不可破的高并发防护罩。  
5. **资源隔离分明的多租户治理与海量名单分页术**：  
   不仅是个人的网盘，还是企业可用的底层隔离应用。在用户层面完成了完全不互相串门的数据和空间配额硬隔离；同时在业务底层，用类似“记书签”的复合游标分页技术彻底淘汰了传统的“从头翻书（OFFSET 分页）”带来的严重耗时衰减，亿级列表页仍旧能够做到秒响应。  
6. **铸造强力防护网与安全底座（动态限流 + 纯净校验 + 防盗链）**：  
   对认证系统做了大胆且彻底的“切除手术”，抛弃老旧的依赖服务器记忆的 Session 模式，全程启用类似“电子通行证”的 JWT 链路，让应用随时可以无限横加服务器扩容。此外，通过挂载自主研发的“一秒上限流”组件 `@RateLimit` 和原生 `Referer` 来源验证拦截，相当于给重要路口安上了智能安检机，无论是恶意流量防刷还是外部无理的盗链白嫖都会被瞬间封锁。  
7. **上帝视角的系统级可观测性（Prometheus/Grafana 数据天网）**：  
   为原本看不见摸不着的服务器脉搏装上了“心电图”和“总控面板”。结合 Actuator/Micrometer 打通所有业务指征、搜集用户使用端层面的健康数据（Web Vitals）并最终形成炫酷、全盘直观反应问题的 Grafana 数据沙盘和预设定报警体系，让开发不再是盲人摸象。  
8. **近乎严苛的出厂级质量屏障体系**：  
   对于这样一个需要经受数据不丢、并发不倒考验的云盘底层，后端建设了覆盖高危路径并发逻辑的严密属性测试（jqwik），前端也毫不妥协地引进了 Playwright 进行全链路仿真人类点击动作排雷，保障每一份打出来的安装包都具备企业交付水准。

## 技术难点与解决方案

### 1) 大文件上传稳定性与一致性：巨兽数据碎片的拼接游戏
- 难点：当成百上千的用户同时往云盘里塞几个 GB 的视频时，极易出现类似“高速公路连环追尾”的碎片乱序、并发过载，甚至由于传输中断导致残缺的脏数据（断点文件）一直占据这服务器的昂贵硬盘配额。  
- 方案：制定了极其严苛的入口“安检”机制。上传前，服务器会预先切分并校验每一块数据的身份证（MD5验证）。通过后端实时的“用户并发限流”卡位，防止个别人吃净总带宽。更为关键的是，只有在最后一块“拼图（分片）”严丝合缝地传完，系统才会正式在数据库盖章承认（事务化）。至于那些由于断网、断电形成的不完整的断片，则交由每日自动巡逻的“扫地僧”（定时任务清理器）默默清除。  
- 收益：让原本脆弱的超大文件上传链路变得“不仅敢断（断点续传），甚至能秒（秒传）”。系统即便遭遇网络极端不稳，也可以无痛回滚、严守空间限制规则。

### 2) 缓存高并发场景下的稳定性：决战尖峰时刻的洪流冲击
- 难点：在诸如热点资源爆火（例如某个学习资料被万人同时下载）的场景下，巨大的流量如果越过缓存直接砸在数据库上，就像不设防的收银台被瞬间挤垮（缓存击穿）；或者大量的非法恶意请求专门索要不存在的文件（缓存穿透），都会拖死甚至干翻整台机器。  
- 方案：搭建了一套立体的防御网（多级缓存分层读取）。先是“前台服务员”（Caffeine 本地缓存）去挡，再由“大堂经理”（Redis）接盘这股热流。为了对付故意寻找漏洞的恶意穿透，更是在门前放置了类似“核验名单”的（布隆过滤器）提前拦截空头访问；万一某份绝版资料过期，则用“分布式锁”当门栓限制仅限一人去数据库查底。配合打散分布的“随机过期时间（随机 TTL）”，绝不让大波文件在同一秒钟集体失效引发雪崩。  
- 收益：即便是面对突如其来的疯狂拉取与分享，系统性能也没有发生陡崖跳水。底层的核心数据库就像身处后台一样高枕无忧。

### 3) 亿级深分页性能衰减：永不降速的“翻书页”技术
- 难点：传统的数据库翻页逻辑（OFFSET）有个致命的硬伤：当你翻到第十万页时，它的速度会随着页码的增加而肉眼可见地变慢，导致页面转半天菊花都出不来结果。  
- 方案：使用一种高级的“复合游标定位法”（以 `create_time + id` 当做下划线）。不管前面有几百几千万数据，我都只凭借“上一条数据的坐标轴（nextCursor）”往下找，也就是我根本不需要像传统的方式那样从第一条数起，这避免了无效的扫描开销。  
- 收益：大基盘场景下（包含成千上万个嵌套文件与高额分享信息墙）的高页数请求从此摆脱了响应超时的魔咒，性能如履平地。

### 4) 多租户上下文隔离：企业级数据互殴的结界
- 难点：既然不仅是供单人使用，当有五百家企业同时在使用该网盘底层代码时，如何做到类似于在同一套公寓里安排五百个互不干扰且保证绝对私密的房间（线程复用下的上下文污染与配额越界）。  
- 方案：设置“入户拦截检查探头”。请求一进来，立马将其身份（租户ID）抓取并死死绑定到他专属的那个线程储物柜里（ThreadLocal）。业务跑完，立刻将储物柜上锁销毁。与此同时，底层涉及存储操作的数据管道工厂严格对“空间账单”设限阻断，确保越狱和混穿绝无可能。  
- 收益：这把单体应用推向了云端级的 SaaS 能力架构。确保了多公司在同时并发操作自身云盘时，不逾规、不越界、资源独立考核。

### 5) 认证体系的无状态终局演进：让系统轻装上阵的“电子工牌”
- 难点：老版本的系统严重依赖带有记忆的服务器认证模式（Session）。每当一台机器不够用了需要横向多增加几台服务器平摊压力时，它就会因为“这家服务器不认识刚刚在另外一家登录的用户”而疯狂弹验证错误。  
- 方案：下定决心对其进行“切除手术”。抛弃了旧有厚重的回退逻辑，而是完全由前端携带类似“电子通行证”的 JWT Token 来证明“我是我”。这种高度加密认证卡片在任何后端容器下都是互认互通的。  
- 收益：一劳永逸地解决了横向扩容（也就是所谓的服务器不够就多买几台拉在一块）时的身份痛点；系统正式进化为 Stateless（无状态）且具备了云原生伸缩潜质。

### 6) 前端渲染风暴与并发主线程负载：OOM（内存爆仓）克星
- 难点：试想一下你点击打开含有整整几万张图片的超级大合集目录，传统的页面绘图代码（DOM更新）会立刻让浏览器休克甚至白屏死机。另外如果一口气选中几千个文件同时校验，算力过载直接导致应用崩溃。  
- 方案：只“伪装渲染”眼前看到的那几页东西。引入了高端的前端黑科技（`vue-virtual-scroller` 回收制可视流缓冲视图），就像拍电影一样，只有跑到镜头前面的演员才在演戏，其后的只是个背景板。这杜绝了浏览器做海量无工。对于批量算力，通过自定义“有限额度”的干活车间（`WorkerPool`），无论丢多少文件进来，永远只有“三个人”在接力干活，保证主线永不阻塞休克。  
- 收益：不管海量网盘装了多少数据，用户翻找翻阅时也感受不到任何吃力。即便对上千个长传列队发起计算，系统也像是一台平稳的轿车般游刃有余。

### 7) 穿透性的可观测闭环：告别盲猜盲改的黑灯瞎火
- 难点：如果线上服务器慢了或者崩了，没有高维的探针，开发人员只能去乱码一样的日志里碰碰运气。不知道哪里慢更不知道哪里的 CPU 在告警。  
- 方案：引入了诸如 Actuator/Micrometer 前端到后端的健康指标。直接收集系统的血压、心跳，甚至用户打开网页的各种“体感参数（Web Vitals）”。并将这无数的数据接入一个大盘沙盒——也就是 Prometheus 搭配 Grafana 监控报警塔。  
- 收益：系统进入透明时代，容量调优更是从“拍脑袋抓瞎”上升成了拥有真实热点反馈的量化游戏，故障排查的黄金抢修期大大缩短。

### 8) 下载网关受限于核心频宽与状态高通病发：冲破速度天花板
- 难点：如果让服务器去搬运网上的视频放给用户看（应用跳板中转），带宽瞬间就会堵车导致下载如龟爬。而在后台转换文件时，前端就像“查岗”一样不停询问后台（定时轮询），不仅没效率还把服务器拖虚脱。  
- 方案：采取了一种近乎作弊的“特批直连”。通过 S3 `Presigner` 直接给请求人发一张效期 2 小时的权限直连罚单，让客户端绕开应用服务器的主网大门，直接去后院的存储库里下数据；那恼人的定时查岗也被改造成了全双工事件推送——也就是后端依托于 **Java 21 廉价到发指的 Virtual Threads 协程**发出的“SseEmitter 订阅信”，只要后端一弄完就不费周折推送给前端报喜。  
- 收益：让本身服务器的网速劣势变得无关紧要，跑满拉满对象云厂商的上行满速率下载体验犹如破堤洪流一般奔涌。

### 9) 防火墙高频探空与防盗链壁垒：智能安检口
- 难点：一旦下载链接外泄，不仅容易招惹各类爬虫夜以继日地搜刮、还会招来他站通过内嵌导致的流量耗散（把我们这当图床白嫖带宽）。  
- 方案：像海关检查行李那样。通过给各种对外公网接口前设下自定义的安抚沙盒标签（`@RateLimit`），比如设定每请求人在一秒只能过 5 次，超出即打上封印。再佐之 HTTP 头部的验明正身（`Referer`），凡是跟我不沾亲带故的网页嵌入全以 600 非法错误拒绝连接。  
- 收益：直接关死并拒付了非法请求发过来的“天价云流量对账单”，在最核心边缘抵住了爬虫探穴。

## 高能 STAR 表达矩阵（可直接运用于简历述职与高阶深度面试）

### STAR 1：大型文件极可靠上传生命周期重排
- **情境 (Situation)**：随着业务量的扩张，大体积图文及音影的传导（尤其在恶劣网络以及移动场景）很容易面临分片传丢、卡死重来以及大量无效碎片堆爆空间的问题。  
- **任务 (Task)**：为网盘的核心大动脉“上传系统”设计一套抗压、不挤占系统配额且具备原子回溯（失败则全部干净化撤回）的完整基建框架。  
- **行动 (Action)**：全面落地多步骤拆分：支持一键秒传判断以及前置资源配额审查；上传过程借着后置事务收口与精细度的状态标定，支持续传抗断；并给不留名的垃圾废弃分段设上定期剿灭的“机器扫地僧”。  
- **结果 (Result)**：自此，海量用户多线高并发上传时，网络与应用的崩坏率呈现跳崖式下跌。不仅显著杜绝了服务器被白嫖塞满的系统级风险，亦令多重复杂状态机拥有自我闭环自愈力。

### STAR 2：高并发防穿透流量防震减灾体系建立
- **情境 (Situation)**：热门网课视频或者爆款分享连接常常会带来几万条短时集束流量直接冲向系统，如果只靠着孱弱的磁盘型老式查询逻辑，服务器很快就会全面掉线。  
- **任务 (Task)**：利用现有架构搭建一道稳固的高强度多层防火圈，以柔克刚消解掉所有冲击浪涌。  
- **行动 (Action)**：构建梯级缓冲层：“Caffeine 第一圈城墙+ Redis 分区接力”，这规避了反复连环去读取热数据的灾害；并巧妙地采用了“空数据预留坑洞”和布隆过滤器以拦停疯狂套取不存在密码的违规爬网攻击。  
- **结果 (Result)**：热点数据的访问就像查字典般信手拈来。最底层的数据库 CPU/内存常年稳居“心电波缓行图”，甚至在瞬时过载大潮前也免去了恐慌式宕机或雪崩失联。

### STAR 3：面向 B 端云原生的多租户 SaaS 围墙能力建设
- **情境 (Situation)**：软件若想商业化售卖或者多部门独立运用，就绝不容许发生“A公司看到B账单、C项目占用完全部带”这种资源互踏事故。  
- **任务 (Task)**：在不大量重写既有代码架构的基础上，打造全链路严格防混交的数据隔离仓及用量节流阀。  
- **行动 (Action)**：我在所有对外大口增设“隐形标识（拦截租户上下文验证）”，确保所有用户的指令流在执行全生命周期都戴着不可摘褪的身份光环。配合租户独立总库隔离设计以及强制前置拦截盘查，把资源按比例精准分装进各部门的沙盒。  
- **结果 (Result)**：顺利支持且推动了向成熟“企业化 SaaS 系统”迈出的技术护城河布局。哪怕同开上千公司盘，也完全可证、互不倾染且严控各家资产边界红线。

### STAR 4：打破数据孤岛的全栈量化可观测基站架构
- **情境 (Situation)**：系统如果缺乏监测工具，它本身就会变成个盲盒，所有关于“卡在哪里”、“为什么页面不动了”、“并发一高哪里冒出了大量报错”的查虫就像摸黑找针一样费劲。  
- **任务 (Task)**：化被动式的事后日志翻看为全天候高透明前瞻级别的立体监测图台，赋予系统感知生命脉搏反馈的灵视能力。  
- **行动 (Action)**：我在系统的后端挂上基于 Micrometer 与端点的 Actuator 心率仪，将所有的吞吐和调用状态发送进“大脑中控室”（Prometheus），并在 Web 网页端塞入谷歌推崇的 Web Vitals 获取加载体验指标，最后用以酷炫且逻辑关联的一套 Grafana 表盘全盘展现。  
- **结果 (Result)**：极大地扭转了系统排错低效劣势面。研发由抓瞎排查转化为被可视化预警，运维甚至可提早发现隐患与过饱容量而无感知调度扩容。性能分析再也不是凭空猜测。

### STAR 5：前后端交互与网络瓶颈双极限跨越（SSE + S3 直连方案）
- **情境 (Situation)**：一旦开始走高分发的高清视频和文件导出，所有的千兆或者百兆入口都被服务器跳板本身拦腰斩断成极微小水管；轮询这种高消耗“傻等”逻辑则持续抽干了服务器应用线程生命力。  
- **任务 (Task)**：直接从核心理念根治大吞吐流向，完全解除长连接这种寄生瘤负载压力。  
- **行动 (Action)**：联合 S3 开放高危临时通牒令 `Presigned URL` ，实现资源直接跟厂商巨构级云基座的脱机挂挡高速连接；抛去沉疴轮询手法，我采纳极低运行阻力且被底层操作系统优待支持的 Java 21 `Virtual Threads(协程)`结合 `SseEmitter` 的超单工全链路事件推动网路技术进行异步下达。  
- **结果 (Result)**：彻底推翻旧体系短板。原本服务器因下载量一大就陷入半数宕机的瓶颈一朝灰飞烟灭。大吞吐流拉升至物理限高百倍速率体验，并真正意义让其退位担当一介无为的智能微型调度总闸。

### STAR 6：客户端极致防护与渲染抗暴（虚拟视窗与防灾沙盒盾牌）
- **情境 (Situation)**：不仅后台，在拥有了几百万数据的文件夹打开场景面前，用户浏览器页面同样会被“疯狂往页面画图（巨量重绘DOM DOM）”逼疯吃土。而公网上暴露的盗链也会招来一帮试图吸干免费外汇宽带的恶意吸血端。  
- **任务 (Task)**：利用极客优化从端上解决浏览器爆栈重载危机；依托代码在边缘上给未防备的后端穿上厚重的阻截护甲圈定疆土安全。  
- **行动 (Action)**：前端以按需的 `vue-virtual-scroller` 长视图进行虚拟投影来代替无脑全画输出，并自定义建立“WorkerPool 约束力工棚”强制分配给 MD5 重计算不高于3并发的核心排班权；后端采用自演化的 Redis-lua 滑块组件给每个易攻点挂上“秒级计数”雷达和原生 `Referer` 判定的外站绝缘围墙抗盗链刷法策略。  
- **结果 (Result)**：端边两点开花。即便是动则过10万超巨型的全量资产盘列表亦能帧率恒定不掉丝滑过关。而服务器后端流量开支大大瘦身，彻底跟白嫖黑灰爬虫流量账单硬说“拜拜”。

## 待补充（建议在投递前完善）
- 压测数据：建议补充并发量、P95/P99、上传成功率、缓存命中率等可量化指标。  
- 规模数据：建议补充用户规模、文件规模、峰值 QPS、日均上传量等业务量级指标。  
- 个人贡献占比：建议明确“我主导/我负责/我参与”边界，避免面试追问时口径不一致。  
