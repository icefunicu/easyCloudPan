# 应用服务 WEB 访问端口
server.port=${SERVER_PORT:7090}
server.servlet.context-path=/api
#session过期时间 60M 一个小时
server.servlet.session.timeout=PT60M
#处理favicon
spring.mvc.favicon.enable=false
spring.servlet.multipart.max-file-size=15MB
spring.servlet.multipart.max-request-size=15MB
#错误页处理
spring.web.resources.add-mappings=false

#数据库配置
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://127.0.0.1:5432/easypan}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:easypan}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:123456}
spring.datasource.driver-class-name=org.postgresql.Driver
# HikariCP 连接池优化配置
spring.datasource.hikari.pool-name=EasyPanHikariCP
# 数据库连接池大小（结合虚拟线程优化）
spring.datasource.hikari.minimum-idle=20
spring.datasource.hikari.maximum-pool-size=200
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1800000
# 降低连接超时时间以更快感知连接问题
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.validation-timeout=5000
# 连接泄漏检测（开发环境）
spring.datasource.hikari.leak-detection-threshold=60000
#发送邮件配置相关
# 配置邮件服务器的地址 smtp.qq.com
spring.mail.host=${SPRING_MAIL_HOST:smtp.qq.com}
# 配置邮件服务器的端口（465或587）
spring.mail.port=${SPRING_MAIL_PORT:465}
# 配置用户的账号
spring.mail.username=${SPRING_MAIL_USERNAME:2041487752@qq.com}
# 配置用户的密码
spring.mail.password=${SPRING_MAIL_PASSWORD:dummy_mail_password}
# 配置默认编码
spring.mail.default-encoding=UTF-8
# SSL 连接配置 (Jakarta Mail 兼容)
spring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory
# 开启 debug，这样方便开发者查看邮件发送日志
spring.mail.properties.mail.debug=true
#邮件配置结束
#Spring redis配置
# Redis数据库索引（默认为0）
spring.data.redis.database=0
spring.data.redis.host=${SPRING_DATA_REDIS_HOST:127.0.0.1}
spring.data.redis.port=${SPRING_DATA_REDIS_PORT:6379}
spring.data.redis.password=${SPRING_DATA_REDIS_PASSWORD:password123}
# 连接池最大连接数（使用负值表示没有限制）
spring.data.redis.jedis.pool.max-active=20
# 连接池最大阻塞等待时间（使用负值表示没有限制）
spring.data.redis.jedis.pool.max-wait=-1
# 连接池中的最大空闲连接
spring.data.redis.jedis.pool.max-idle=10
# 连接池中的最小空闲连接
spring.data.redis.jedis.pool.min-idle=0
# 连接超时时间（毫秒）
spring.data.redis.timeout=2000
#项目目录
project.folder=${PROJECT_FOLDER:file/}

# MinIO配置
minio.endpoint=${MINIO_ENDPOINT:http://127.0.0.1:9000}
minio.accessKey=${MINIO_ACCESS_KEY:minioadmin}
minio.secretKey=${MINIO_SECRET_KEY:minioadminpassword}
minio.bucketName=${MINIO_BUCKET_NAME:easypan}
# MinIO 连接池配置（虚拟线程优化）
# 最大连接数（高连接限制以支持虚拟线程并发）
minio.max-connections=1000
# 连接超时时间（毫秒）
minio.connection-timeout=10000
# 套接字超时时间（毫秒）
minio.socket-timeout=30000

# 开启虚拟线程 (Java 21)
spring.threads.virtual.enabled=true

# 虚拟线程优化配置
# 是否启用虚拟线程执行器优化（用于 @Async 异步操作）
virtual-threads.enabled=true
# 虚拟线程名称前缀（用于监控和调试）
virtual-threads.name-prefix=vt-async-

#日志级别配置
log.root.level=${LOG_ROOT_LEVEL:debug}
#超级管理员id
admin.emails=${ADMIN_EMAILS:admin@example.com}
#是否是开发环境
dev=${DEV_MODE:false}
##qq登陆相关##
qq.app.id=${QQ_APP_ID:dummy_app_id}
qq.app.key=${QQ_APP_KEY:dummy_app_key}
qq.url.authorization=https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=%s&redirect_uri=%s&state=%s
qq.url.access.token=https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&client_id=%s&client_secret=%s&code=%s&redirect_uri=%s
qq.url.openid=https://graph.qq.com/oauth2.0/me?access_token=%S
qq.url.user.info=https://graph.qq.com/user/get_user_info?access_token=%s&oauth_consumer_key=%s&openid=%s
qq.url.redirect=${QQ_URL_REDIRECT:http://localhost:8080/qqlogincallback}

# Flyway Database Migration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=false
spring.flyway.out-of-order=false

# Actuator Monitoring
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
management.metrics.enable.http=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true

# Jackson configuration
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=GMT+8

# MyBatis-Flex Configuration
mybatis-flex.type-aliases-package=com.easypan.entity.po
mybatis-flex.configuration.map-underscore-to-camel-case=true
mybatis-flex.configuration.log-impl=org.apache.ibatis.logging.slf4j.Slf4jImpl
mybatis-flex.enable-sql-annotation=false

# JWT Configuration
jwt.secret=defaultSecretKeyRequires256BitsMinimumLengthForHS256AlgorithmIsHere
jwt.expiration=604800000
jwt.refresh-expiration=2592000000

# Jasypt Encryption Configuration
jasypt.encryptor.password=${JASYPT_ENCRYPTOR_PASSWORD:easypan_secure_key}
jasypt.encryptor.algorithm=PBEWITHHMACSHA512ANDAES_256
jasypt.encryptor.iv-generator-classname=org.jasypt.iv.RandomIvGenerator
jasypt.encryptor.provider-name=SunJCE
jasypt.encryptor.output-type=base64
jasypt.encryptor.string-output-type=base64
