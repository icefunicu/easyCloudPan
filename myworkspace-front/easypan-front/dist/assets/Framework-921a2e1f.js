import{g as ie,_ as X,a as G,r as b,e as S,f,h as w,i,F as T,x as H,t as M,l as L,m as D,y as j,z as W,A as O,j as h,q as Y,s as Z,b as K,w as g,n as E,k as ee,v as te,u as ue,B as ce,C as de}from"./index-e609a1ae.js";var se={exports:{}};(function(U,I){(function($){U.exports=$()})(function($){var x=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function _(o,n){var t=o[0],e=o[1],a=o[2],s=o[3];t+=(e&a|~e&s)+n[0]-680876936|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&a)+n[1]-389564586|0,s=(s<<12|s>>>20)+t|0,a+=(s&t|~s&e)+n[2]+606105819|0,a=(a<<17|a>>>15)+s|0,e+=(a&s|~a&t)+n[3]-1044525330|0,e=(e<<22|e>>>10)+a|0,t+=(e&a|~e&s)+n[4]-176418897|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&a)+n[5]+1200080426|0,s=(s<<12|s>>>20)+t|0,a+=(s&t|~s&e)+n[6]-1473231341|0,a=(a<<17|a>>>15)+s|0,e+=(a&s|~a&t)+n[7]-45705983|0,e=(e<<22|e>>>10)+a|0,t+=(e&a|~e&s)+n[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&a)+n[9]-1958414417|0,s=(s<<12|s>>>20)+t|0,a+=(s&t|~s&e)+n[10]-42063|0,a=(a<<17|a>>>15)+s|0,e+=(a&s|~a&t)+n[11]-1990404162|0,e=(e<<22|e>>>10)+a|0,t+=(e&a|~e&s)+n[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&a)+n[13]-40341101|0,s=(s<<12|s>>>20)+t|0,a+=(s&t|~s&e)+n[14]-1502002290|0,a=(a<<17|a>>>15)+s|0,e+=(a&s|~a&t)+n[15]+1236535329|0,e=(e<<22|e>>>10)+a|0,t+=(e&s|a&~s)+n[1]-165796510|0,t=(t<<5|t>>>27)+e|0,s+=(t&a|e&~a)+n[6]-1069501632|0,s=(s<<9|s>>>23)+t|0,a+=(s&e|t&~e)+n[11]+643717713|0,a=(a<<14|a>>>18)+s|0,e+=(a&t|s&~t)+n[0]-373897302|0,e=(e<<20|e>>>12)+a|0,t+=(e&s|a&~s)+n[5]-701558691|0,t=(t<<5|t>>>27)+e|0,s+=(t&a|e&~a)+n[10]+38016083|0,s=(s<<9|s>>>23)+t|0,a+=(s&e|t&~e)+n[15]-660478335|0,a=(a<<14|a>>>18)+s|0,e+=(a&t|s&~t)+n[4]-405537848|0,e=(e<<20|e>>>12)+a|0,t+=(e&s|a&~s)+n[9]+568446438|0,t=(t<<5|t>>>27)+e|0,s+=(t&a|e&~a)+n[14]-1019803690|0,s=(s<<9|s>>>23)+t|0,a+=(s&e|t&~e)+n[3]-187363961|0,a=(a<<14|a>>>18)+s|0,e+=(a&t|s&~t)+n[8]+1163531501|0,e=(e<<20|e>>>12)+a|0,t+=(e&s|a&~s)+n[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,s+=(t&a|e&~a)+n[2]-51403784|0,s=(s<<9|s>>>23)+t|0,a+=(s&e|t&~e)+n[7]+1735328473|0,a=(a<<14|a>>>18)+s|0,e+=(a&t|s&~t)+n[12]-1926607734|0,e=(e<<20|e>>>12)+a|0,t+=(e^a^s)+n[5]-378558|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^a)+n[8]-2022574463|0,s=(s<<11|s>>>21)+t|0,a+=(s^t^e)+n[11]+1839030562|0,a=(a<<16|a>>>16)+s|0,e+=(a^s^t)+n[14]-35309556|0,e=(e<<23|e>>>9)+a|0,t+=(e^a^s)+n[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^a)+n[4]+1272893353|0,s=(s<<11|s>>>21)+t|0,a+=(s^t^e)+n[7]-155497632|0,a=(a<<16|a>>>16)+s|0,e+=(a^s^t)+n[10]-1094730640|0,e=(e<<23|e>>>9)+a|0,t+=(e^a^s)+n[13]+681279174|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^a)+n[0]-358537222|0,s=(s<<11|s>>>21)+t|0,a+=(s^t^e)+n[3]-722521979|0,a=(a<<16|a>>>16)+s|0,e+=(a^s^t)+n[6]+76029189|0,e=(e<<23|e>>>9)+a|0,t+=(e^a^s)+n[9]-640364487|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^a)+n[12]-421815835|0,s=(s<<11|s>>>21)+t|0,a+=(s^t^e)+n[15]+530742520|0,a=(a<<16|a>>>16)+s|0,e+=(a^s^t)+n[2]-995338651|0,e=(e<<23|e>>>9)+a|0,t+=(a^(e|~s))+n[0]-198630844|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~a))+n[7]+1126891415|0,s=(s<<10|s>>>22)+t|0,a+=(t^(s|~e))+n[14]-1416354905|0,a=(a<<15|a>>>17)+s|0,e+=(s^(a|~t))+n[5]-57434055|0,e=(e<<21|e>>>11)+a|0,t+=(a^(e|~s))+n[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~a))+n[3]-1894986606|0,s=(s<<10|s>>>22)+t|0,a+=(t^(s|~e))+n[10]-1051523|0,a=(a<<15|a>>>17)+s|0,e+=(s^(a|~t))+n[1]-2054922799|0,e=(e<<21|e>>>11)+a|0,t+=(a^(e|~s))+n[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~a))+n[15]-30611744|0,s=(s<<10|s>>>22)+t|0,a+=(t^(s|~e))+n[6]-1560198380|0,a=(a<<15|a>>>17)+s|0,e+=(s^(a|~t))+n[13]+1309151649|0,e=(e<<21|e>>>11)+a|0,t+=(a^(e|~s))+n[4]-145523070|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~a))+n[11]-1120210379|0,s=(s<<10|s>>>22)+t|0,a+=(t^(s|~e))+n[2]+718787259|0,a=(a<<15|a>>>17)+s|0,e+=(s^(a|~t))+n[9]-343485551|0,e=(e<<21|e>>>11)+a|0,o[0]=t+o[0]|0,o[1]=e+o[1]|0,o[2]=a+o[2]|0,o[3]=s+o[3]|0}function l(o){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=o.charCodeAt(t)+(o.charCodeAt(t+1)<<8)+(o.charCodeAt(t+2)<<16)+(o.charCodeAt(t+3)<<24);return n}function m(o){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=o[t]+(o[t+1]<<8)+(o[t+2]<<16)+(o[t+3]<<24);return n}function k(o){var n=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,a,s,d,A,c;for(e=64;e<=n;e+=64)_(t,l(o.substring(e-64,e)));for(o=o.substring(e-64),a=o.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<a;e+=1)s[e>>2]|=o.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(_(t,s),e=0;e<16;e+=1)s[e]=0;return d=n*8,d=d.toString(16).match(/(.*?)(.{0,8})$/),A=parseInt(d[2],16),c=parseInt(d[1],16)||0,s[14]=A,s[15]=c,_(t,s),t}function B(o){var n=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,a,s,d,A,c;for(e=64;e<=n;e+=64)_(t,m(o.subarray(e-64,e)));for(o=e-64<n?o.subarray(e-64):new Uint8Array(0),a=o.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<a;e+=1)s[e>>2]|=o[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(_(t,s),e=0;e<16;e+=1)s[e]=0;return d=n*8,d=d.toString(16).match(/(.*?)(.{0,8})$/),A=parseInt(d[2],16),c=parseInt(d[1],16)||0,s[14]=A,s[15]=c,_(t,s),t}function R(o){var n="",t;for(t=0;t<4;t+=1)n+=x[o>>t*8+4&15]+x[o>>t*8&15];return n}function C(o){var n;for(n=0;n<o.length;n+=1)o[n]=R(o[n]);return o.join("")}C(k("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function o(n,t){return n=n|0||0,n<0?Math.max(n+t,0):Math.min(n,t)}ArrayBuffer.prototype.slice=function(n,t){var e=this.byteLength,a=o(n,e),s=e,d,A,c,F;return t!==$&&(s=o(t,e)),a>s?new ArrayBuffer(0):(d=s-a,A=new ArrayBuffer(d),c=new Uint8Array(A),F=new Uint8Array(this,a,d),c.set(F),A)}}();function p(o){return/[\u0080-\uFFFF]/.test(o)&&(o=unescape(encodeURIComponent(o))),o}function y(o,n){var t=o.length,e=new ArrayBuffer(t),a=new Uint8Array(e),s;for(s=0;s<t;s+=1)a[s]=o.charCodeAt(s);return n?a:e}function v(o){return String.fromCharCode.apply(null,new Uint8Array(o))}function z(o,n,t){var e=new Uint8Array(o.byteLength+n.byteLength);return e.set(new Uint8Array(o)),e.set(new Uint8Array(n),o.byteLength),t?e:e.buffer}function u(o){var n=[],t=o.length,e;for(e=0;e<t-1;e+=2)n.push(parseInt(o.substr(e,2),16));return String.fromCharCode.apply(String,n)}function r(){this.reset()}return r.prototype.append=function(o){return this.appendBinary(p(o)),this},r.prototype.appendBinary=function(o){this._buff+=o,this._length+=o.length;var n=this._buff.length,t;for(t=64;t<=n;t+=64)_(this._hash,l(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},r.prototype.end=function(o){var n=this._buff,t=n.length,e,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s;for(e=0;e<t;e+=1)a[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(a,t),s=C(this._hash),o&&(s=u(s)),this.reset(),s},r.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},r.prototype.setState=function(o){return this._buff=o.buff,this._length=o.length,this._hash=o.hash,this},r.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},r.prototype._finish=function(o,n){var t=n,e,a,s;if(o[t>>2]|=128<<(t%4<<3),t>55)for(_(this._hash,o),t=0;t<16;t+=1)o[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(e[2],16),s=parseInt(e[1],16)||0,o[14]=a,o[15]=s,_(this._hash,o)},r.hash=function(o,n){return r.hashBinary(p(o),n)},r.hashBinary=function(o,n){var t=k(o),e=C(t);return n?u(e):e},r.ArrayBuffer=function(){this.reset()},r.ArrayBuffer.prototype.append=function(o){var n=z(this._buff.buffer,o,!0),t=n.length,e;for(this._length+=o.byteLength,e=64;e<=t;e+=64)_(this._hash,m(n.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(n.buffer.slice(e-64)):new Uint8Array(0),this},r.ArrayBuffer.prototype.end=function(o){var n=this._buff,t=n.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a,s;for(a=0;a<t;a+=1)e[a>>2]|=n[a]<<(a%4<<3);return this._finish(e,t),s=C(this._hash),o&&(s=u(s)),this.reset(),s},r.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.ArrayBuffer.prototype.getState=function(){var o=r.prototype.getState.call(this);return o.buff=v(o.buff),o},r.ArrayBuffer.prototype.setState=function(o){return o.buff=y(o.buff,!0),r.prototype.setState.call(this,o)},r.ArrayBuffer.prototype.destroy=r.prototype.destroy,r.ArrayBuffer.prototype._finish=r.prototype._finish,r.ArrayBuffer.hash=function(o,n){var t=B(new Uint8Array(o)),e=C(t);return n?u(e):e},r})})(se);var pe=se.exports;const fe=ie(pe);const he=U=>(Y("data-v-ce178d54"),U=U(),Z(),U),_e={class:"uploader-panel"},ve=he(()=>i("div",{class:"uploader-title"},[i("span",null,"上传任务"),i("span",{class:"tips"},"（仅展示本次上传任务）")],-1)),me={class:"file-list"},ye={class:"file-item"},ge={class:"upload-panel"},we={class:"file-name"},be={class:"progress"},Ce={class:"upload-status"},Ae={key:0,class:"upload-info"},Se={class:"op"},Ue={class:"op-btn"},$e={key:0},Fe={key:0},N=1024*1024*5,Ie={__name:"Uploader",emits:["uploadCallback"],setup(U,{expose:I,emit:$}){const{proxy:x}=G(),_={upload:"/file/uploadFile"},l={emptyfile:{value:"emptyfile",desc:"文件为空",color:"#F75000",icon:"close"},fail:{value:"fail",desc:"上传失败",color:"#F75000",icon:"close"},init:{value:"init",desc:"解析中",color:"#e6a23c",icon:"clock"},uploading:{value:"uploading",desc:"上传中",color:"#409eff",icon:"upload"},upload_finish:{value:"upload_finish",desc:"上传完成",color:"#67c23a",icon:"ok"},upload_seconds:{value:"upload_seconds",desc:"秒传",color:"#67c23a",icon:"ok"}},m=b([]),k=b([]);I({addFile:async(u,r)=>{const o={file:u,uid:u.uid,md5Progress:0,md5:null,fileName:u.name,status:l.init.value,uploadSize:0,totalSize:u.size,uploadProgress:0,pause:!1,chunkIndex:0,filePid:r,errorMsg:null};if(m.value.unshift(o),o.totalSize==0){o.status=l.emptyfile.value;return}let n=await y(o);n!=null&&z(n)}});const R=u=>{let r=v(u);r.pause=!1,z(u,r.chunkIndex)},C=u=>{let r=v(u);r.pause=!0},p=(u,r)=>{k.value.push(u),m.value.splice(r,1)},y=u=>{let r=u.file,o=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,n=Math.ceil(r.size/N),t=0,e=new fe.ArrayBuffer,a=new FileReader;new Date().getTime();let s=()=>{let d=t*N,A=d+N>=r.size?r.size:d+N;a.readAsArrayBuffer(o.call(r,d,A))};return s(),new Promise((d,A)=>{let c=v(r.uid);a.onload=F=>{if(e.append(F.target.result),t++,t<n){console.log(`第${r.name}, ${t}分片解析完成, 开始第${t+1}`);let V=Math.floor(t/n*100);c.md5Progress=V,s()}else{let V=e.end();e.destroy(),c.md5Progress=100,c.status=l.uploading.value,c.md5=V,d(u.uid)}},a.onerror=()=>{c.md5Progress=-1,c.status=l.fail.value,d(u.uid)}}).catch(d=>null)},v=u=>m.value.find(o=>o.file.uid===u),z=async(u,r)=>{r=r||0;let o=v(u);const n=o.file,t=o.totalSize,e=Math.ceil(t/N);for(let a=r;a<e;a++){let s=k.value.indexOf(u);if(s!=-1){k.value.splice(s,1);break}if(o=v(u),o.pause)break;let d=a*N,A=d+N>=t?t:d+N,c=n.slice(d,A),F=await x.Request({url:_.upload,showLoading:!1,dataType:"file",params:{file:c,fileName:n.name,fileMd5:o.md5,chunkIndex:a,chunks:e,fileId:o.fileId,filePid:o.filePid},showError:!1,errorCallback:V=>{o.status=l.fail.value,o.errorMsg=V},uploadProgressCallback:V=>{let q=V.loaded;q>t&&(q=t),o.uploadSize=a*N+q,o.uploadProgress=Math.floor(o.uploadSize/t*100)}});if(F==null)break;if(o.fileId=F.data.fileId,o.status=l[F.data.status].value,o.chunkIndex=a,F.data.status==l.upload_seconds.value||F.data.status==l.upload_finish.value){o.uploadProgress=100,$("uploadCallback");break}}};return(u,r)=>{const o=S("el-progress"),n=S("Icon"),t=S("NoData");return f(),w("div",_e,[ve,i("div",me,[(f(!0),w(T,null,H(m.value,(e,a)=>(f(),w("div",ye,[i("div",ge,[i("div",we,M(e.fileName),1),i("div",be,[e.status==l.uploading.value||e.status==l.upload_seconds.value||e.status==l.upload_finish.value?(f(),L(o,{key:0,percentage:e.uploadProgress},null,8,["percentage"])):D("",!0)]),i("div",Ce,[i("span",{class:j(["iconfont","icon-"+l[e.status].icon]),style:W({color:l[e.status].color})},null,6),i("span",{class:"status",style:W({color:l[e.status].color})},M(e.status=="fail"?e.errorMsg:l[e.status].desc),5),e.status==l.uploading.value?(f(),w("span",Ae,M(O(x).Utils.size2Str(e.uploadSize))+" / "+M(O(x).Utils.size2Str(e.totalSize)),1)):D("",!0)])]),i("div",Se,[e.status==l.init.value?(f(),L(o,{key:0,type:"circle",width:50,percentage:e.md5Progress},null,8,["percentage"])):D("",!0),i("div",Ue,[e.status===l.uploading.value?(f(),w("span",$e,[e.pause?(f(),L(n,{key:0,width:28,class:"btn-item",iconName:"upload",title:"上传",onClick:s=>R(e.uid)},null,8,["onClick"])):(f(),L(n,{key:1,width:28,class:"btn-item",iconName:"pause",title:"暂停",onClick:s=>C(e.uid)},null,8,["onClick"]))])):D("",!0),e.status!=l.init.value&&e.status!=l.upload_finish.value&&e.status!=l.upload_seconds.value?(f(),L(n,{key:1,width:28,class:"del btn-item",iconName:"del",title:"删除",onClick:s=>p(e.uid,a)},null,8,["onClick"])):D("",!0),e.status==l.upload_finish.value||e.status==l.upload_seconds.value?(f(),L(n,{key:2,width:28,class:"clean btn-item",iconName:"clean",title:"清除",onClick:s=>p(e.uid,a)},null,8,["onClick"])):D("",!0)])])]))),256)),m.value.length==0?(f(),w("div",Fe,[h(t,{msg:"暂无上传任务"})])):D("",!0)])])}}},xe=X(Ie,[["__scopeId","data-v-ce178d54"]]);const Pe={class:"avatar-upload"},Be={class:"avatar-show"},Re=["src"],ke=["src"],Ve=["src"],ze={class:"select-btn"},Me={__name:"AvatarUpload",props:{modelValue:{type:Object,default:null}},setup(U,{emit:I}){G(),K(),K(),b("");const $=b(null),x=async _=>{_=_.file;let l=new FileReader;l.readAsDataURL(_),l.onload=({target:m})=>{$.value=m.result},I("update:modelValue",_)};return(_,l)=>{const m=S("el-button"),k=S("el-upload");return f(),w("div",Pe,[i("div",Be,[$.value?(f(),w("img",{key:0,src:$.value},null,8,Re)):(f(),w(T,{key:1},[U.modelValue&&U.modelValue.qqAvatar?(f(),w("img",{key:0,src:`${U.modelValue.qqAvatar}`},null,8,ke)):(f(),w("img",{key:1,src:`/api/getAvatar/${U.modelValue.userId}`},null,8,Ve))],64))]),i("div",ze,[h(k,{name:"file","show-file-list":!1,accept:".png,.PNG,.jpg,.JPG,.jpeg,.JPEG,.gif,.GIF,.bmp,.BMP",multiple:!1,"http-request":x},{default:g(()=>[h(m,{class:"select-button",type:"primary"},{default:g(()=>[E("选择")]),_:1})]),_:1})])])}}},De={__name:"UpdateAvatar",setup(U,{expose:I,emit:$}){const{proxy:x}=G(),_={updateUserAvatar:"updateUserAvatar"},l=b({}),m=b();I({show:C=>{l.value=Object.assign({},C),l.value.avatar={userId:C.userId,qqAvatar:C.avatar},B.value.show=!0}});const B=b({show:!1,title:"修改头像",buttons:[{type:"primary",text:"确定",click:C=>{R()}}]}),R=async()=>{if(!(l.value.avatar instanceof File)){B.value.show=!1;return}if(!await x.Request({url:_.updateUserAvatar,params:{avatar:l.value.avatar}}))return;B.value.show=!1;const p=x.VueCookies.get("userInfo");delete p.avatar,x.VueCookies.set("userInfo",p,0),$("updateAvatar")};return(C,p)=>{const y=S("el-form-item"),v=S("el-form"),z=S("Dialog");return f(),w("div",null,[h(z,{show:B.value.show,title:B.value.title,buttons:B.value.buttons,width:"500px",showCancel:!1,onClose:p[2]||(p[2]=u=>B.value.show=!1)},{default:g(()=>[h(v,{model:l.value,ref_key:"formDataRef",ref:m,"label-width":"80px",onSubmit:p[1]||(p[1]=ee(()=>{},["prevent"]))},{default:g(()=>[h(y,{label:"昵称"},{default:g(()=>[E(M(l.value.nickName),1)]),_:1}),h(y,{label:"头像",prop:""},{default:g(()=>[h(Me,{modelValue:l.value.avatar,"onUpdate:modelValue":p[0]||(p[0]=u=>l.value.avatar=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}},Ne=i("span",{class:"iconfont icon-password"},null,-1),qe=i("span",{class:"iconfont icon-password"},null,-1),Le={__name:"UpdatePassword",setup(U,{expose:I}){const{proxy:$}=G(),x={updatePassword:"updatePassword"},_=(p,y,v)=>{y!==l.value.rePassword?v(new Error(p.message)):v()},l=b({}),m=b(),k={password:[{required:!0,message:"请输入密码"},{validator:$.Verify.password,message:"密码只能是数字,字母,特殊字符8-18位"}],rePassword:[{required:!0,message:"请再次输入密码"},{validator:_,message:"两次输入的密码不一致"}]};I({show:()=>{R.value.show=!0,te(()=>{m.value.resetFields(),l.value={}})}});const R=b({show:!1,title:"修改密码",buttons:[{type:"primary",text:"确定",click:p=>{C()}}]}),C=async()=>{m.value.validate(async p=>{!p||!await $.Request({url:x.updatePassword,params:{password:l.value.password}})||(R.value.show=!1,$.Message.success("密码修改成功"))})};return(p,y)=>{const v=S("el-input"),z=S("el-form-item"),u=S("el-form"),r=S("Dialog");return f(),w("div",null,[h(r,{show:R.value.show,title:R.value.title,buttons:R.value.buttons,width:"500px",showCancel:!1,onClose:y[3]||(y[3]=o=>R.value.show=!1)},{default:g(()=>[h(u,{model:l.value,rules:k,ref_key:"formDataRef",ref:m,"label-width":"80px",onSubmit:y[2]||(y[2]=ee(()=>{},["prevent"]))},{default:g(()=>[h(z,{label:"新密码",prop:"password"},{default:g(()=>[h(v,{type:"password",size:"large",placeholder:"请输入密码",modelValue:l.value.password,"onUpdate:modelValue":y[0]||(y[0]=o=>l.value.password=o),modelModifiers:{trim:!0},"show-password":""},{prefix:g(()=>[Ne]),_:1},8,["modelValue"])]),_:1}),h(z,{label:"确认密码",prop:"rePassword"},{default:g(()=>[h(v,{type:"password",size:"large",placeholder:"请再次输入密码",modelValue:l.value.rePassword,"onUpdate:modelValue":y[1]||(y[1]=o=>l.value.rePassword=o),modelModifiers:{trim:!0},"show-password":""},{prefix:g(()=>[qe]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}};const Q=U=>(Y("data-v-80748b0e"),U=U(),Z(),U),je={class:"framework"},Te={class:"header"},Ee=Q(()=>i("div",{class:"logo"},[i("span",{class:"iconfont icon-pan"}),i("div",{class:"name"},"Easy云盘")],-1)),Ge={class:"right-panel"},Oe=Q(()=>i("span",{class:"iconfont icon-transfer"},null,-1)),Je={class:"user-info"},He={class:"avatar"},Ke={class:"nick-name"},Qe={class:"body"},We={class:"left-sider"},Xe={class:"menu-list"},Ye=["onClick"],Ze={class:"text"},et={class:"menu-sub-list"},tt=["onClick"],st={class:"text"},at={key:0,class:"tips"},ot={class:"space-info"},nt=Q(()=>i("div",null,"空间使用",-1)),lt={class:"percent"},rt={class:"space-use"},it={class:"use"},ut={class:"body-content"},ct={__name:"Framework",setup(U){const{proxy:I}=G(),$=ue(),x=K(),_={logout:"/logout",getUseSpace:"/getUseSpace"},l=b(!1),m=b(),k=c=>{const{file:F,filePid:V}=c;l.value=!0,m.value.addFile(F,V)},B=b(),R=()=>{te(()=>{B.value.reload(),A()})},C=b(0),p=b(I.VueCookies.get("userInfo")),y=[{icon:"cloude",name:"首页",menuCode:"main",path:"/main/all",allShow:!0,children:[{icon:"all",name:"全部",category:"all",path:"/main/all"},{icon:"video",name:"视频",category:"video",path:"/main/video"},{icon:"music",name:"音频",category:"music",path:"/main/music"},{icon:"image",name:"图片",category:"image",path:"/main/image"},{icon:"doc",name:"文档",category:"doc",path:"/main/doc"},{icon:"more",name:"其他",category:"others",path:"/main/others"}]},{path:"/myshare",icon:"share",name:"分享",menuCode:"share",allShow:!0,children:[{name:"分享记录",path:"/myshare"}]},{path:"/recycle",icon:"del",name:"回收站",menuCode:"recycle",tips:"回收站为你保存10天内删除的文件",allShow:!0,children:[{name:"删除的文件",path:"/recycle"}]},{path:"/settings/fileList",icon:"settings",name:"设置",menuCode:"settings",allShow:!1,children:[{name:"用户文件",path:"/settings/fileList"},{name:"用户管理",path:"/settings/userList"},{name:"系统设置",path:"/settings/sysSetting"}]}],v=b({}),z=b(),u=c=>{!c.path||c.menuCode==v.value.menuCode||$.push(c.path)},r=(c,F)=>{const V=y.find(q=>q.menuCode===c);v.value=V,z.value=F};ce(()=>x,(c,F)=>{c.meta.menuCode&&r(c.meta.menuCode,c.path)},{immediate:!0,deep:!0});const o=b(),n=()=>{o.value.show(p.value)},t=()=>{p.value=I.VueCookies.get("userInfo"),C.value=new Date().getTime()},e=b(),a=()=>{e.value.show()},s=async()=>{I.Confirm("你确定要退出吗",async()=>{await I.Request({url:_.logout})&&(I.VueCookies.remove("userInfo"),$.push("/login"))})},d=b({useSpace:0,totalSpace:1}),A=async()=>{let c=await I.Request({url:_.getUseSpace,showLoading:!1});c&&(d.value=c.data)};return A(),(c,F)=>{const V=S("el-popover"),q=S("Avatar"),J=S("el-dropdown-item"),ae=S("el-dropdown-menu"),oe=S("el-dropdown"),ne=S("el-progress"),le=S("router-view");return f(),w("div",je,[i("div",Te,[Ee,i("div",Ge,[h(V,{width:800,trigger:"click",visible:l.value,"onUpdate:visible":F[0]||(F[0]=P=>l.value=P),offset:20,transition:"none","hide-after":0,"popper-style":{padding:"0px"}},{reference:g(()=>[Oe]),default:g(()=>[h(xe,{ref_key:"uploaderRef",ref:m,onUploadCallback:R},null,512)]),_:1},8,["visible"]),h(oe,null,{dropdown:g(()=>[h(ae,null,{default:g(()=>[h(J,{onClick:n},{default:g(()=>[E("修改头像")]),_:1}),h(J,{onClick:a},{default:g(()=>[E("修改密码")]),_:1}),h(J,{onClick:s},{default:g(()=>[E("退出")]),_:1})]),_:1})]),default:g(()=>[i("div",Je,[i("div",He,[h(q,{userId:p.value.userId,avatar:p.value.avatar,timestamp:C.value,width:46},null,8,["userId","avatar","timestamp"])]),i("span",Ke,M(p.value.nickName),1)])]),_:1})])]),i("div",Qe,[i("div",We,[i("div",Xe,[(f(),w(T,null,H(y,P=>(f(),w(T,null,[P.allShow||!P.allShow&&p.value.admin?(f(),w("div",{key:0,onClick:re=>u(P),class:j(["menu-item",P.menuCode==v.value.menuCode?"active":""])},[i("div",{class:j(["iconfont","icon-"+P.icon])},null,2),i("div",Ze,M(P.name),1)],10,Ye)):D("",!0)],64))),64))]),i("div",et,[(f(!0),w(T,null,H(v.value.children,P=>(f(),w("div",{onClick:re=>u(P),class:j(["menu-item-sub",z.value==P.path?"active":""])},[P.icon?(f(),w("span",{key:0,class:j(["iconfont","icon-"+P.icon])},null,2)):D("",!0),i("span",st,M(P.name),1)],10,tt))),256)),v.value&&v.value.tips?(f(),w("div",at,M(v.value.tips),1)):D("",!0),i("div",ot,[nt,i("div",lt,[h(ne,{percentage:Math.floor(d.value.useSpace/d.value.totalSpace*1e4)/100,color:"#f701ff"},null,8,["percentage"])]),i("div",rt,[i("div",it,M(O(I).Utils.size2Str(d.value.useSpace))+" / "+M(O(I).Utils.size2Str(d.value.totalSpace)),1),i("div",{class:"iconfont icon-refresh",onClick:A})])])])]),i("div",ut,[h(le,null,{default:g(({Component:P})=>[(f(),L(de(P),{ref_key:"routerViewRef",ref:B,onAddFile:k,onReload:A},null,544))]),_:1})])]),h(De,{ref_key:"updateAvatarRef",ref:o,onUpdateAvatar:t},null,512),h(Le,{ref_key:"updatePasswordRef",ref:e},null,512)])}}},pt=X(ct,[["__scopeId","data-v-80748b0e"]]);export{pt as default};
